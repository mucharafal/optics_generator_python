interfaceOptions =  `root-config --libs` `root-config --glibs` -I`root-config --incdir` -I./../interface
compileOptions = -c -std=c++17
obj:
	mkdir ./../obj
	g++ $(compileOptions) -fPIC $(interfaceOptions) FitCint.cc 				-o ./../obj/FitCint.o
	g++ $(compileOptions) -fPIC $(interfaceOptions) TMultiDimFet.cc 				-o ./../obj/TMultiDimFet.o
	g++ $(compileOptions) -fPIC $(interfaceOptions) TNtupleDcorr.cc 				-o ./../obj/TNtupleDcorr.o
	g++ $(compileOptions) -fPIC $(interfaceOptions) LHCOpticsApproximator.cc -o ./../obj/LHCOpticsApproximator.o

pathToRootLibraries = ../../../../root_libs
shared: obj
	
	gcc -shared $(interfaceOptions) ./../obj/LHCOpticsApproximator.o ./../obj/TMultiDimFet.o ./../obj/TNtupleDcorr.o ./../obj/FitCint.o -o $(pathToRootLibraries)/LHCOpticsApproximator.so
	rootcint -f $(pathToRootLibraries)/FitCint.cxx -c $(interfaceOptions) ../interface/FitCintLinkDef.h

# to remove, use only to specify path to file.so generated by shared
export:
	export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/rafalmucha/Pobrane/optic/optics_generator_python/root_libs

clean:
	rm -rf ./../obj
	rm -rf $(pathToRootLibraries)

k:	clean
	mkdir $(pathToRootLibraries)
	rootcint -f ./FitCint.cc -c ./../interface/LHCOpticsApproximator.h ./../interface/TMultiDimFet.h ./../interface/TNtupleDcorr.h ./../interface/FitCintLinkDef.h
	mv ./FitCint_rdict.pcm $(pathToRootLibraries)
	rootcint -f $(pathToRootLibraries)/LHCOpticsApproximator.cxx -c ./../interface/LHCOpticsApproximator.h ./../interface/TMultiDimFet.h ./../interface/TNtupleDcorr.h ./../interface/FitCintLinkDef.h 
	rm $(pathToRootLibraries)/LHCOpticsApproximator.cxx* 